<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<style>

    .button-group{
        display: flex;
        margin-right: 10px;
        a{
        }
        img{
            width: 20px;
            height: 20px;
            margin-right: 10px;

        }
    }
</style>
<body>

<section class="container" id="customerMain">

    <h1>Customer Details</h1>


    <section id="customerAddForm" class="container">
        <form id="customerForm">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="customerId">Customer ID</label>
                    <input type="text" class="form-control" id="customerId" placeholder="Customer ID" value="" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="customerName">Customer Name</label>
                    <input type="text" class="form-control" id="customerName" placeholder="Customer Name" value="" required>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="userId">User ID</label>
                    <input type="text" class="form-control" id="userId" placeholder="User ID" value="" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="gender">Gender</label>
                    <select class="form-control" id="gender" required>
                        <option value="MALE">Male</option>
                        <option value="FEMALE">Female</option>
                        <option value="OTHER">Other</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="joinDate">Join Date</label>
                    <input type="date" class="form-control" id="joinDate" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="level">Loyalty Level</label>
                    <select class="form-control" id="level" required>
                        <option value="GOLD">Gold</option>
                        <option value="SILVER">Silver</option>
                        <option value="BRONZE">Bronze</option>
                        <option value="NEW">New</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="totalPoints">Total Points</label>
                    <input type="number" class="form-control" id="totalPoints" placeholder="Total Points" value="" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="dob">Date of Birth</label>
                    <input type="date" class="form-control" id="dob" required>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="addressLine1">Building No.</label>
                    <input type="text" class="form-control" id="addressLine1" placeholder="Address Line 1" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="addressLine2">Lane</label>
                    <input type="text" class="form-control" id="addressLine2" placeholder="Address Line 2" required>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="addressLine3">City</label>
                    <input type="text" class="form-control" id="addressLine3" placeholder="Address Line 3" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="addressLine4">State</label>
                    <input type="text" class="form-control" id="addressLine4" placeholder="Address Line 4" required>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="addressLine5">Postal Code</label>
                    <input type="text" class="form-control" id="addressLine5" placeholder="Address Line 5" required>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="conNo">Contact No.</label>
                    <input type="text" class="form-control" id="conNo" placeholder="" required>
                </div>
            </div>
            <div class="form-group">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="" id="isActive" required>
                    <label class="form-check-label" for="isActive">
                        Active
                    </label>
                </div>
            </div>
            <button class="btn btn-primary" type="button" onclick="saveCustomer()">Submit form</button>
        </form>
    </section>

    <section id="customerTblForm" class="container">
        <div class="container">


            <ul id="customerList"></ul>



            <div class="table-responsive">
                <table class="table text-nowrap align-middle mb-0">
                    <thead>

                    <tr>
                        <th scope="col" class="text-title fw-normal fs-14 pt-0 ps-0">Customer ID</th>
                        <th scope="col" class="text-title fw-normal fs-14 pt-0">Customer Name</th>
                        <th scope="col" class="text-title fw-normal fs-14 pt-0">Leve</th>
                        <th scope="col" class="text-title fw-normal fs-14 pt-0">Total Points</th>
                        <th scope="col" class="text-title fw-normal fs-14 pt-0">Contact No.</th>
                        <th scope="col" class="text-title fw-normal fs-14 pt-0">Email</th>
                        <th scope="col" class="text-title fw-normal fs-14 pt-0">Address</th>
                        <th scope="col" class="text-title fw-normal fs-14 pt-0">Action</th>
                    </tr>
                    </thead>

                    <tbody id="customerTbl">
                    <tr>
                        <td>1</td>
                        <td>John Doe</td>
                        <td>GOLD</td>
                        <td>100</td>
                        <td>1234567890</td>
                        <td>lharshana2002@gmail.com</td>
                        <td>weligama</td>
                        <td>
                            <div class="button-group d-flex flex-wrap align-items-center">
                                <a href="customerview.html" class="" title="View">
                                    <img src="../assets/eye.png" alt="Image">
                                </a>
                                <a href="#" class="" title="Edit">
                                    <img src="../assets/edit.png" alt="Image">
                                </a>
                                <a class="delete-btn" data-bs-toggle="offcanvas"
                                   href="#" role="button" aria-controls="deletePopup">
                                    <img src="../assets/delete.png" alt="Image"></a>
                            </div>
                        </td>
                    </tbody>
                </table>
            </div>

            <button onclick="get()">get</button>
        </div>

    </section>


</section>



<script>
    function saveCustomer() {


        console.log('Save Customer ha i haijai ');
        // const now = new Date();
        // const customerId = document.getElementById('customerId').value;
        // const customerName = document.getElementById('customerName').value;
        // const userId = document.getElementById('userId').value;
        // const gender = document.getElementById('gender').value;
        // const joinDate = formatDate(document.getElementById('joinDate').value);
        // const dob = formatDate(document.getElementById('dob').value);
        // const level = document.getElementById('level').value;
        // const totalPoints = document.getElementById('totalPoints').value;
        // const addressLine1 = document.getElementById('addressLine1').value;
        // const addressLine2 = document.getElementById('addressLine2').value;
        // const addressLine3 = document.getElementById('addressLine3').value;
        // const addressLine4 = document.getElementById('addressLine4').value;
        // const addressLine5 = document.getElementById('addressLine5').value;
        // const contactNo = document.getElementById('conNo').value;
        // const isActive = document.getElementById('isActive').checked;

       const customerData = {
            "customerId": "2",
            "customerName": "John Doe",
            "userId": "1",
            "gender": "MALE",
            "joinDate": "2024-04-26",
            "level": "GOLD",
            "totalPoints": 100,
            "dob": "1990-01-01",
            "addressLine1": "123 Main St",
            "addressLine2": "Apt 101",
            "addressLine3": "City",
            "addressLine4": "State",
            "addressLine5": "12345",
            "contactNo": "1234567890",
            "email": "john.doe@example.com",
            "recentPurchaseDateTime": "2024-04-26T14:00:00",
            "createBy": "admin",
            "modifyBy": "admin",
            "isActive": true
        };


        const token = "eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJsYWhpcnUiLCJpYXQiOjE3MTQyMzU1MDcsImV4cCI6MTcxNDMyMTkwN30.oPw9pKpyxjEv_vO2ash2YEhhaPEXiEbHOqDcxqJS-4o";

        fetch('http://localhost:8081/app/api/v1/customer', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            },
            body: JSON.stringify(customerData)
        })
            .then(response => response.json())
            .then(data => {
                alert('Customer saved successfully');
            })
            .catch(error => {
                console.error('Error:', error);
            });
    }

    function get() {
        const token = "eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJsYWhpcnUiLCJpYXQiOjE3MTQyMzU1MDcsImV4cCI6MTcxNDMyMTkwN30.oPw9pKpyxjEv_vO2ash2YEhhaPEXiEbHOqDcxqJS-4o";

        fetch('http://localhost:8081/app/api/v1/customer', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`

            }
        })
            .then(response => response.json())
            .then(data => {
                if (data && data.length > 0) {
                    localStorage.setItem('customers', JSON.stringify(data));
                    renderCustomers(data);
                } else {
                    console.log('No data received from the server.');
                }
            })
            .catch(error => console.error('Error fetching data:', error));

        function renderCustomers(customers) {
            const customerTableBody = document.getElementById('customerTbl');
            customerTableBody.innerHTML = '';

            customers.forEach(customer => {
                const newRow = document.createElement('tr');
                const customerIdCell = document.createElement('td');
                customerIdCell.textContent = customer.customerId;
                newRow.appendChild(customerIdCell);

                const customerNameCell = document.createElement('td');
                customerNameCell.textContent = customer.customerName;
                newRow.appendChild(customerNameCell);

                const levelCell = document.createElement('td');
                levelCell.textContent = customer.level;
                newRow.appendChild(levelCell);

                const totalPointsCell = document.createElement('td');
                totalPointsCell.textContent = customer.totalPoints;
                newRow.appendChild(totalPointsCell);

                const contactNoCell = document.createElement('td');
                contactNoCell.textContent = customer.contactNo;
                newRow.appendChild(contactNoCell);

                const emailCell = document.createElement('td');
                emailCell.textContent = customer.email;
                newRow.appendChild(emailCell);

                const addressCell = document.createElement('td');
                addressCell.textContent = `${customer.addressLine1}, ${customer.addressLine2}, ${customer.addressLine3}, ${customer.addressLine4}, ${customer.addressLine5}`;
                newRow.appendChild(addressCell);

                const actionCell = document.createElement('td');
                const buttonGroup = document.createElement('div');
                buttonGroup.className = 'button-group d-flex flex-wrap align-items-center';

                const viewLink = document.createElement('a');
                viewLink.href = `customerView.html?customerId=${customer.customerId}`;
                viewLink.title = 'View';
                viewLink.innerHTML = '<img src="../assets/eye.png" alt="View">';
                buttonGroup.appendChild(viewLink);

                const editLink = document.createElement('a');
                editLink.href = 'customerEdit.html';
                editLink.title = 'Edit';
                editLink.innerHTML = '<img src="../assets/edit.png" alt="Edit">';
                buttonGroup.appendChild(editLink);

                const deleteLink = document.createElement('a');
                deleteLink.className = 'delete-btn';
                deleteLink.setAttribute('data-bs-toggle', 'offcanvas');
                deleteLink.href = '#';
                deleteLink.role = 'button';
                deleteLink.setAttribute('aria-controls', 'deletePopup');
                deleteLink.innerHTML = '<img src="../assets/delete.png" alt="Delete">';
                buttonGroup.appendChild(deleteLink);

                actionCell.appendChild(buttonGroup);
                newRow.appendChild(actionCell);
                customerTableBody.appendChild(newRow);
            });
        }
    }





</script>

</body>
</html>
