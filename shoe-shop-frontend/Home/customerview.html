<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer View</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container">
    <h1>Customer View</h1>

    <div class="row">
        <div class="col-md-6">
            <table class="table">
                <thead>
                <tr>
                    <th>Field</th>
                    <th>Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th>Customer ID</th>
                    <td id="customerId"></td>
                </tr>
                <tr>
                    <th>Customer Name</th>
                    <td id="customerName"></td>
                </tr>
                <tr>
                    <th>User ID</th>
                    <td id="userId"></td>
                </tr>
                <tr>
                    <th>Gender</th>
                    <td id="gender"></td>
                </tr>
                <tr>
                    <th>Join Date</th>
                    <td id="joinDate"></td>
                </tr>
                <tr>
                    <th>Loyalty Level</th>
                    <td id="loyaltyLevel"></td>
                </tr>
                <tr>
                    <th>Total Points</th>
                    <td id="totalPoints"></td>
                </tr>
                <tr>
                    <th>Date of Birth</th>
                    <td id="dob"></td>
                </tr>
                <tr>
                    <th>Address</th>
                    <td id="address"></td>
                </tr>
                <tr>
                    <th>Contact No</th>
                    <td id="contactNo"></td>
                </tr>
                <tr>
                    <th>Email</th>
                    <td id="email"></td>
                </tr>
                <tr>
                    <th>Recent Purchase Date Time</th>
                    <td id="recentPurchaseDateTime"></td>
                </tr>
                <tr>
                    <th>Created By</th>
                    <td id="createBy"></td>
                </tr>
                <tr>
                    <th>Modified By</th>
                    <td id="modifyBy"></td>
                </tr>
                <tr>
                    <th>Active</th>
                    <td id="isActive"></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>


    function loadCustomerData(customer) {
        document.getElementById('customerId').textContent = customer.customerId;
        document.getElementById('customerName').textContent = customer.customerName;
        document.getElementById('userId').textContent = customer.userId;
        document.getElementById('gender').textContent = customer.gender ? customer.gender : '';
        document.getElementById('joinDate').textContent = formatDate(customer.joinDate);
        document.getElementById('loyaltyLevel').textContent = customer.level ? customer.level : '';
        document.getElementById('totalPoints').textContent = customer.totalPoints ? customer.totalPoints : '';
        document.getElementById('dob').textContent = formatDate(customer.dob);
        document.getElementById('address').textContent = `${customer.addressLine1}, ${customer.addressLine2}, ${customer.addressLine3}, ${customer.addressLine4}, ${customer.addressLine5}`;
        document.getElementById('contactNo').textContent = customer.contactNo;
        document.getElementById('email').textContent = customer.email;
        document.getElementById('recentPurchaseDateTime').textContent = formatDate(customer.recentPurchaseDateTime);
        document.getElementById('createBy').textContent = customer.createBy;
        document.getElementById('modifyBy').textContent = customer.modifyBy;
        document.getElementById('isActive').textContent = customer.isActive ? 'Yes' : 'No';
    }

    // Helper function to format date
    function formatDate(dateString) {
        if (!dateString) return '';
        const date = new Date(dateString);
        return date.toLocaleDateString();
    }
    // Function to retrieve URL parameter by name
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        const results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }

    // Fetch customer ID from URL parameter
    const customerId = getUrlParameter('customerId');

    const token = "eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJsYWhpcnUiLCJpYXQiOjE3MTQyMzU1MDcsImV4cCI6MTcxNDMyMTkwN30.oPw9pKpyxjEv_vO2ash2YEhhaPEXiEbHOqDcxqJS-4o";


    // Use the customer ID to fetch customer data and load it into the table
    // Example fetch function:
    fetch(`http://localhost:8081/app/api/v1/customer/${customerId}`, {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
        }
    })
        .then(response => response.json())
        .then(customer => {
            // Load customer data into the table using the loadCustomerData function
            loadCustomerData(customer);
        })
        .catch(error => {
            console.error('Error fetching customer data:', error);
        });

</script>
</body>
</html>
